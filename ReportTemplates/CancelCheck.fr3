<?xml version="1.0" encoding="utf-8" standalone="no"?>
<Tgs_fr4SingleReport Version="4.8.2" DotMatrixReport="True" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39770.5769802431" ReportOptions.Description.Text="" ReportOptions.LastChange="40708.729398044" ScriptLanguage="PascalScript" ScriptText.Text="procedure OnBeforeReportPrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Header: TgsDataSet;&#13;&#10;  DateBegin, DateEnd: TDate;&#13;&#10;  BaseQuery: QueryList;&#13;&#10;  DocID, LineID, PrnGrID: Integer;&#13;&#10;  S, PrinterName, CompName: String;                         &#13;&#10;begin&#13;&#10;  DocID := StrToInt(&#60;DocID&#62;);&#13;&#10;  LineID := StrToInt(&#60;LineID&#62;);&#13;&#10;  PrnGrID := StrToInt(&#60;PrnGrID&#62;);&#13;&#10;&#13;&#10;  PrinterName := &#60;PrinterName&#62;;&#13;&#10;  CompName := &#60;ComputerName&#62;;                    &#13;&#10;  &#13;&#10;  BaseQuery := GetQueryList;                                &#13;&#10;  BaseQuery.Clear;&#13;&#10;&#13;&#10;  Header := BaseQuery.Query(BaseQuery.Add('HEADER', False));&#13;&#10;  S :=&#13;&#10;    'select ' +&#13;&#10;    '  doc.documentdate, doc.number as NUM, ' +&#13;&#10;    '  comp.name compname,  ' +&#13;&#10;    '  o.usr$guestcount guest, ' +&#13;&#10;    '  con.name conname, o.usr$timeorder as open1,  ' +&#13;&#10;    '  current_time as time1, ' +&#13;&#10;    '  ol.documentkey,                              ' +&#13;&#10;    '  g.alias, g.name as goodname,                 ' +&#13;&#10;    '  prngr.usr$name as prngroupname,              ' +&#13;&#10;    '  ol.usr$quantity as q,                        ' +&#13;&#10;    '  setprn.usr$printername as printername,       ' +&#13;&#10;    '  cause.usr$name as cn                         ' +&#13;&#10;    'from                                           ' +&#13;&#10;    '  gd_document doc                              ' +&#13;&#10;    '  join usr$mn_order o on doc.id = o.documentkey and doc.id = :docid  ' +&#13;&#10;    '  join usr$mn_orderline ol on o.documentkey = ol.masterkey ' +&#13;&#10;    '    and ol.documentkey = :lineID                           ' +&#13;&#10;    '  join gd_document docl on docl.id = ol.documentkey        ' +&#13;&#10;    '  join gd_good g on g.id = ol.usr$goodkey                  ' +&#13;&#10;    '  join usr$mn_prngroup prngr on prngr.id = g.usr$prngroupkey   ' +&#13;&#10;    '  join usr$mn_prngroupset setprn on setprn.usr$prngroup = prngr.id   ' +&#13;&#10;    '  JOIN gd_contact comp ON comp.id = doc.companykey                   ' +&#13;&#10;    '  JOIN USR$MN_CAUSEDELETEORDERLINE cause on cause.id = ol.usr$causedeletekey  ' +&#13;&#10;    '  LEFT JOIN usr$mn_p_getcontact_department(o.usr$respkey) cd ON 0 = 0  ' +&#13;&#10;    '  LEFT JOIN gd_contact con ON con.id = cd.peoplekey        ' +&#13;&#10;    '  LEFT JOIN gd_contact dept ON dept.id = cd.departmentkey  ' +&#13;&#10;    'where                                                      ' +&#13;&#10;    '  setprn.usr$printername = :printername                    ' +&#13;&#10;    '  and ol.usr$causedeletekey is not null                    ' +&#13;&#10;    '  and setprn.usr$computername = :COMP                      ' +&#13;&#10;    '  and setprn.usr$kassa = 0 ';&#13;&#10;  if PrnGrID &#60;&#62; 0 then&#13;&#10;    S := S + '  and prngr.id = :prngrid ';&#13;&#10;  Header.SQL := S;&#13;&#10;  Header.ParamByName('docid').AsInteger := DocID;&#13;&#10;  Header.ParamByName('LineID').AsInteger := LineID;&#13;&#10;  Header.ParambyName('printername').AsString := PrinterName;&#13;&#10;  Header.ParambyName('comp').AsString := CompName;&#13;&#10;  if PrnGrID &#60;&#62; 0 then&#13;&#10;    Header.ParambyName('prngrid').Value := PrnGrID;&#13;&#10;  Header.Open;       &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." ShowProgress="False" OnBeforeReportPrint="OnBeforeReportPrint" PropData="0844617461736574730100095661726961626C657301010612204E616D653D222052657374506172616D220001061B204E616D653D2250726E47724944222056616C75653D222730272200010619204E616D653D22446F634944222056616C75653D22273027220001061A204E616D653D224C696E654944222056616C75653D22273027220001061E204E616D653D225072696E7465724E616D65222056616C75653D2227272200010626204E616D653D22436F6D70757465724E616D65222056616C75653D2227415355532D504327220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxDMPPage Name="Page1" PaperWidth="99.0599360237913" PaperHeight="296.862308276426" PaperSize="256" LeftMargin="2.53999835958439" RightMargin="2.53999835958439" TopMargin="4.49791376176403" BottomMargin="4.49791376176403" ColumnWidth="0" ColumnPositions.Text="" EndlessHeight="True" HGuides.Text="" VGuides.Text="" FontStyle="0">
    <TfrxReportTitle Name="ReportTitle1" Height="170" Left="0" Top="17" Width="355.2">
      <TfrxDMPCommand Name="DMPCommand1" Description="Reset Printer" Left="0" Top="0" Width="355.2" Height="17" Hint="Reset Printer" ShowHint="False" Command="1B401B703020201D2101"/>
      <TfrxDMPMemoView Name="DMPMemo2" Left="0" Top="34" Width="355.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="-------------------------------------"/>
      <TfrxDMPMemoView Name="DMPMemo3" Left="0" Top="51" Width="67.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="Номер:"/>
      <TfrxDMPMemoView Name="DMPMemo4" Left="0" Top="68" Width="96" Height="17" ShowHint="False" FontStyle="256" ParentFont="False" TruncOutboundText="False" Text="Официант:"/>
      <TfrxDMPMemoView Name="DMPMemo5" Left="0" Top="85" Width="57.6" Height="17" ShowHint="False" TruncOutboundText="False" Text="Дата:"/>
      <TfrxDMPMemoView Name="DMPMemo6" Left="0" Top="102" Width="76.8" Height="17" ShowHint="False" TruncOutboundText="False" Text="Гостей:"/>
      <TfrxDMPMemoView Name="DMPMemo7" Left="172.8" Top="85" Width="67.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="Время:"/>
      <TfrxDMPMemoView Name="DMPMemo8" Left="124.8" Top="102" Width="115.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="Стол открыт:"/>
      <TfrxDMPMemoView Name="DMPMemo9" Left="67.2" Top="51" Width="288" Height="17" ShowHint="False" TruncOutboundText="False" Text="[HEADER.&#34;NUM&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo10" Left="96" Top="68" Width="259.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="[HEADER.&#34;CONNAME&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo11" Left="57.6" Top="85" Width="115.2" Height="17" ShowHint="False" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" TruncOutboundText="False" Text="[HEADER.&#34;DOCUMENTDATE&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo12" Left="240" Top="85" Width="115.2" Height="17" ShowHint="False" DisplayFormat.FormatStr="hh:mm:ss" DisplayFormat.Kind="fkDateTime" TruncOutboundText="False" Text="[HEADER.&#34;TIME1&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo13" Left="76.8" Top="102" Width="38.4" Height="17" ShowHint="False" TruncOutboundText="False" Text="[HEADER.&#34;GUEST&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo14" Left="240" Top="102" Width="115.2" Height="17" ShowHint="False" DisplayFormat.FormatStr="hh:mm:ss" DisplayFormat.Kind="fkDateTime" TruncOutboundText="False" Text="[HEADER.&#34;OPEN1&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo15" Left="0" Top="119" Width="355.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="-------------------------------------"/>
      <TfrxDMPMemoView Name="DMPMemo16" Left="0" Top="153" Width="355.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="-------------------------------------"/>
      <TfrxDMPMemoView Name="DMPMemo17" Left="0" Top="136" Width="288" Height="17" ShowHint="False" HAlign="haCenter" TruncOutboundText="False" Text="Название ОТМЕНЕННОГО блюда"/>
      <TfrxDMPMemoView Name="DMPMemo18" Left="288" Top="136" Width="67.2" Height="17" ShowHint="False" HAlign="haCenter" TruncOutboundText="False" Text="Кол-во"/>
      <TfrxDMPMemoView Name="DMPMemo23" Left="0" Top="17" Width="355.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="***************ОТМЕНА****************"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="51" Left="0" Top="221" Width="355.2" ColumnWidth="0" ColumnGap="0" DataSetName="HEADER" RowCount="0" Stretched="True">
      <TfrxDMPMemoView Name="DMPMemo19" Left="0" Top="0" Width="288" Height="17" ShowHint="False" StretchMode="smActualHeight" DataSetName="HEADER" FontStyle="64" ParentFont="False" WordWrap="False" TruncOutboundText="False" Text="[HEADER.&#34;GOODNAME&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo20" Left="288" Top="0" Width="67.2" Height="17" ShowHint="False" StretchMode="smActualHeight" FontStyle="64" HAlign="haRight" ParentFont="False" TruncOutboundText="False" Text="[HEADER.&#34;Q&#34;]"/>
      <TfrxDMPMemoView Name="DMPMemo21" Left="0" Top="34" Width="355.2" Height="17" ShowHint="False" TruncOutboundText="False" Text="-------------------------------------"/>
      <TfrxDMPMemoView Name="DMPMemo22" Left="0" Top="17" Width="355.2" Height="17" ShowHint="False" StretchMode="smActualHeight" DataSetName="HEADER" FontStyle="64" ParentFont="False" WordWrap="False" TruncOutboundText="False" Text="        [HEADER.&#34;CN&#34;]"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="34" Left="0" Top="306" Width="355.2">
      <TfrxDMPCommand Name="DMPCommand3" Description="Page Break" Left="0" Top="0" Width="355.2" Height="17" Hint="Page Break" ShowHint="False" Command="1D5601"/>
      <TfrxDMPMemoView Name="DMPMemo1" Left="0" Top="17" Width="355.2" Height="17" ShowHint="False" TruncOutboundText="False" Text=""/>
    </TfrxReportSummary>
  </TfrxDMPPage>
</Tgs_fr4SingleReport>
