<?xml version="1.0" encoding="utf-8" standalone="no"?>
<Tgs_fr4SingleReport Version="4.8.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40494.8309578935" ReportOptions.Description.Text="" ReportOptions.LastChange="40708.7303739815" ScriptLanguage="PascalScript" ScriptText.Text="procedure OnBeforeReportPrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Header2, Header1, Header: TgsDataSet;&#13;&#10;  DateBegin, DateEnd: TDate;&#13;&#10;  BaseQuery: QueryList;                                                                 &#13;&#10;begin&#13;&#10;  DateBegin := StrToDate(&#60;DateBegin&#62;);                           &#13;&#10;  DateEnd := StrToDate(&#60;DateEnd&#62;);                                 &#13;&#10;&#13;&#10;  BaseQuery := GetQueryList;                                &#13;&#10;  BaseQuery.Clear;                               &#13;&#10;  Header2 := BaseQuery.Query[BaseQuery.Add('Report2', False)];&#13;&#10;  Header2.SQL :=&#13;&#10;    'select ' +&#13;&#10;    '   pt.usr$name , ' +&#13;&#10;    '   c.usr$name as groupname, ' +&#13;&#10;    '   sum(rc.summ) as ss  ' +&#13;&#10;    'from ' +&#13;&#10;    '  usr$mn_p_cashreport_kassa(:begindate, :enddate) rc ' +&#13;&#10;    '  left join  usr$mn_order o on rc.orderkey = o.documentkey ' +&#13;&#10;    '  left join usr$mn_kindtype kt on rc.kindtypekey = kt.id ' +&#13;&#10;    '  left join usr$inv_paytype pt on pt.id = kt.usr$paytypekey ' +&#13;&#10;    '  left join usr$mn_category c on c.id = rc.categorykey ' +&#13;&#10;    'group by ' +&#13;&#10;    '  1, 2 ' +&#13;&#10;    '  order by 2,1 ';            &#13;&#10;  Header2.ParamByName('begindate').AsDate := EncodeDate(2011, 1, 1);     &#13;&#10;  Header2.ParamByName('enddate').AsDate := EncodeDate(2011, 6, 1);&#13;&#10;  Header2.Open;&#13;&#10;  &#13;&#10;  Header1 := BaseQuery.Query[BaseQuery.Add('Report', False)];&#13;&#10;  Header1.SQL :=&#13;&#10;    'select ' +&#13;&#10;    '   pt.usr$name , ' +&#13;&#10;    '   c.usr$name as groupname, ' +&#13;&#10;    '   sum(rc.summ) as ss  ' +&#13;&#10;    'from ' +&#13;&#10;    '  usr$mn_p_cashreport_kassa(:begindate, :enddate) rc ' +&#13;&#10;    '  left join  usr$mn_order o on rc.orderkey = o.documentkey ' +&#13;&#10;    '  left join usr$mn_kindtype kt on rc.kindtypekey = kt.id ' +&#13;&#10;    '  left join usr$inv_paytype pt on pt.id = kt.usr$paytypekey ' +&#13;&#10;    '  left join usr$mn_category c on c.id = rc.categorykey ' +&#13;&#10;    'group by ' +&#13;&#10;    '  1, 2 ' +&#13;&#10;    '  order by 1,2 ';&#13;&#10;  Header1.ParamByName('begindate').AsDate := DateBegin;&#13;&#10;  Header1.ParamByName('enddate').AsDate := DateEnd;&#13;&#10;  Header1.Open;&#13;&#10;&#13;&#10;  Header := BaseQuery.Query[BaseQuery.Add('Header', True)];&#13;&#10;  Header.AddField('FromDate', 'ftDate', 0, False);&#13;&#10;  Header.AddField('ToDate', 'ftDate', 0, False);&#13;&#10;  Header.AddField('CompanyName', 'ftString', 255, False);&#13;&#10;  Header.Open;&#13;&#10;&#13;&#10;  Header.Append;&#13;&#10;  Header.FieldByName('FromDate').AsString := &#60;DateBegin&#62;;&#13;&#10;  Header.FieldByName('ToDate').AsString := &#60;DateEnd&#62;;                                                                            &#13;&#10;  Header.FieldByName('CompanyName').AsString := &#60;CompanyName&#62;;                                                                              &#13;&#10;  Header.Post;                            &#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." ShowProgress="False" OnBeforeReportPrint="OnBeforeReportPrint" PropData="0844617461736574730100095661726961626C657301010612204E616D653D222052657374506172616D2200010626204E616D653D2244617465426567696E222056616C75653D222731342E30362E32303131272200010624204E616D653D2244617465456E64222056616C75653D222731342E30362E3230313127220001148C000000204E616D653D22436F6D70616E794E616D65222056616C75653D2227D09AD0B0D184D0B52020D090D0BCD181D182D0B5D180D0B4D0B0D0BC20D0A4D0B8D0BBD0B8D0B0D0BB20D09ED09ED09E20262333343BD0A2D0B0D0B1D0B0D0BA2DD0B8D0BDD0B2D0B5D181D182262333343B20D0A2D0A620262333343BD09AD0BED180D0BED0BDD0B0262333343B27220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" PaperWidth="79" PaperHeight="1000" PaperSize="256" LeftMargin="5" RightMargin="5" TopMargin="5" BottomMargin="5" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="22.67718" Left="0" Top="18.89765" Width="260.78757">
      <TfrxMemoView Name="Memo1" Align="baClient" Left="0" Top="0" Width="260.78757" Height="22.67718" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Выручка с [HEADER.&#34;FromDAte&#34;] по [HEADER.&#34;ToDAte&#34;]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="18.89765" Left="0" Top="147.40167" Width="260.78757" ColumnWidth="0" ColumnGap="0" DataSetName="Report" RowCount="0">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="132.28355" Height="18.89765" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[REPORT.&#34;GROUPNAME&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="132.28355" Top="0" Width="128.50402" Height="18.89765" ShowHint="False" DisplayFormat.ThousandSeparator=" " DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[REPORT.&#34;SS&#34;]"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer1" Height="22.67718" Left="0" Top="230.55133" Width="260.78757">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="260.78757" Height="18.89765" ShowHint="False" DisplayFormat.ThousandSeparator=" " DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;REPORT.&#34;SS&#34;&#62;)]"/>
    </TfrxFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="22.67718" Left="0" Top="102.04731" Width="260.78757" Condition="REPORT.&#34;USR$NAME&#34;">
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="260.78757" Height="22.67718" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[REPORT.&#34;USR$NAME&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" Height="18.89765" Left="0" Top="188.9765" Width="260.78757">
      <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="260.78757" Height="18.89765" ShowHint="False" DisplayFormat.ThousandSeparator=" " DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;REPORT.&#34;SS&#34;&#62;)]"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
</Tgs_fr4SingleReport>
